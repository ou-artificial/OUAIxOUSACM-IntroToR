---
title: "Brief Intro To Clustering in R (And Also R Markdown)"
author: "Khoi Trinh"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Before working with R markdown, we need a few packages
```{r rmd}
# The rmarkdown package
#install.packages('rmarkdown')
```

If you want to generate pdf files, you will need to install LaTeX

If you don't plan on using LaTeX anywhere outside of R markdown,
I suggest TinyTex

```{r latex}
#install.packages('tinytex')
#tinytex::install_tinytex()
```

Note that you can and should run these above commands in the RStudio console

# Let's Explore Clustering

```{r libraries, warning=FALSE, message=FALSE}
library(cluster)
library(NbClust)
library(factoextra)
library(dplyr)
library(kmed)
```

## First, we need some data

### Data description

The data I chose is my own Spotify streaming history for the past year.

### Misc data processing:

Read in the data

```{r load data}
spotify = read.csv("final.csv")
```

The data had almost 60,000 observations, out of those, only the numeric data will be considered.

```{r convert to factor}
numericData = spotify %>% #Add data
  dplyr::select(where(is.numeric)) #finds where is.numeric is true
#numericData <- head(numericData, 10000) # gets only 10000 observations
numericData <- subset(numericData, select=-c(1,2,5,7,14,15))
```

## Time To Create Some Clusters

### One last data processing step

Scale the data, and use that to create our clusters.

```{r scale}
clusterData <- scale(numericData)
```

### K means

For this clustering method, the kmeans() function from the stats package is used. Let's start with 2 clusters. Normally, there are ways to determine an optimal number of clusters, but for the sake of simplicity, let's stick to 2, maybe we can change it later.

```{r k mean}
kmean <- kmeans(clusterData,2, nstart=10)
```

### Clusters Analysis

First, let's see the size of the clusters

```{r size}
kmeansize <- kmean$size
kmeansize
```

We have 2 clusters, with size 36053 and 20157. 

Visually, the clusters look like so

```{r k means visual}
fviz_cluster(kmean, data = clusterData, geom = "point", ellipse.type = "convex", 
             ggtheme = theme_bw())
```

### Cluster Intepretation

```{r k mean clusters}
kmeaninfo <- data.frame(kmean$centers, kmean$size)
kmeaninfo
```

Here are the explanation of the traits.

acousticness — how acoustic

danceability — self-explanatory

energy — how 'fast, loud an noisy'

instrumentalness — the less vocals, the higher

liveness — whether there is audience in the recording

loudness — self-explanatory

speechiness — the more spoken words, the higher

valence — whether the track sounds happy or sad

tempo — the bpm

Let's increase the number of clusters, to see if we get any more clear separation.

```{r k mean redux}
kmean2 <- kmeans(clusterData,3, nstart=10)
```

```{r k means visual redux}
fviz_cluster(kmean2, data = clusterData, geom = "point", ellipse.type = "convex", 
             ggtheme = theme_bw())
```

```{r k mean clusters redux}
kmeaninfo2 <- data.frame(kmean2$centers, kmean2$size)
kmeaninfo2
```